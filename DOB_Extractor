New-Item -Path '.\Desktop\' -Name "Patient_Name_DOB.txt" -ItemType "file" -Value "" -Force | Out-Null;Set-Variable -Name "curUser" -Value ($pwd.Path -replace("C.*\\.*\\","")); @("\\cmhs.org\profiles\$curUser\Documents\Unit Patients.htm", "C:\Users\$curUser\Desktop\Unit Patients.htm", "C:\Users\$curUser\Downloads\Unit Patients.htm") | ForEach { if (Test-Path $_){Set-Variable -Name "pathUnitPatients" -Value $_} }; Select-String -Path $pathUnitPatients -Pattern '(bedfield-text)|(patientfield button)|(patientfield name)|(class=age-)' | ForEach-Object { $_.Line -replace '\n|.*<.*bedfield.*\.|\s\S*D>|.*title=\D?|\".*patientfield.*|\sclass.*','' | Out-File -append -FilePath '.\Desktop\Patient_Name_DOB.txt' }; Clear-Variable -Name "pathUnitPatients"; Clear-Variable -Name "curUser"
